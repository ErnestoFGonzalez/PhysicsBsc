# Author: Ernesto González
# Date: 01/11/2019

import pylab
import numpy as np
import math
from sklearn.linear_model import LinearRegression



def linear_regression_line_coordinates(x,y):
    x = np.array(x).reshape(-1,1)
    y = np.array(y)
    model = LinearRegression().fit(x,y)
    r_sq = model.score(x,y)
    slope = model.coef_
    intercept = model.intercept_
    x_line = np.linspace(0,0.05,100)
    y_line = slope*x_line + intercept
    return x_line,y_line,slope

def linear_regression_line_coordinates_magnets(x,y):
    x = np.array(x).reshape(-1,1)
    y = np.array(y)
    model = LinearRegression().fit(x,y)
    r_sq = model.score(x,y)
    slope = model.coef_
    intercept = model.intercept_
    x_line = np.linspace(0,16.5,100)
    y_line = slope*x_line + intercept
    return x_line,y_line,slope



##########################RESULTADOS############################################
avg = (2.36594061+3.47532334+2.9027268+2.60181814+2.68471514+2.98126287+3.47532334
     +3.63869615+3.49733553+3.13442077+3.0099368+3.02984265)/12
values = [2.36594061,3.47532334,2.9027268,2.60181814,2.68471514,2.98126287,3.47532334,
          3.63869615,3.49733553,3.13442077,3.0099368,3.02984265]
sum = 0
for val in values:
    sum +=(val-avg)**2
desvio_padrao = math.sqrt(sum/(11))
print(desvio_padrao)
print(avg)
w = 1112 # angular speed of the motor who pulls the rod

numero_imanes = [4,6,8,10,12,16]
intensidadeB_l_4 = []
intensidadeB_l_2_70 = []
intensidadeB_l_2_10 = []
intensidadeB_r7_85 = []
intensidadeB_r_16 = []
intensidadeB_r_31_90 = []

# plots emf for 4 magnets, each line is a length
linear_reg_4_l4 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.005,0.008,0.014])
linear_reg_4_l2_70 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.004,0.006,0.01])
linear_reg_4_l2_10 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.002,0.004,0.007])
pylab.figure(figsize=(12,10))
# pylab.title("FEM induzida em função do raio do enrolamento do fio. Configuração 4 ímans.")
pylab.plot(linear_reg_4_l4[0], linear_reg_4_l4[1],'r--')
pylab.plot([0.00785,0.016,0.0319], [0.005,0.008,0.014], 'ro', label=r'$\ell=4.00\pm0.05cm$')
pylab.plot(linear_reg_4_l2_70[0], linear_reg_4_l2_70[1],'k--')
pylab.plot([0.00785,0.016,0.0319], [0.004,0.006,0.01], 'ko', label=r'$\ell=2.70\pm0.05cm$')
pylab.plot(linear_reg_4_l2_10[0], linear_reg_4_l2_10[1],'b--')
pylab.plot([0.00785,0.016,0.0319], [0.002,0.004,0.007], 'bo', label=r'$\ell=2.10\pm0.05cm$')
pylab.legend(fontsize=23)
pylab.xticks(fontsize=23)
pylab.yticks(fontsize=23)
pylab.xlabel(r"$r(m)$",fontsize=23)
pylab.ylabel(r"$\epsilon(mV)$",fontsize=23)
pylab.savefig("i4rfem.png")
pylab.show()
print("declive para 4 ímanes l=4",linear_reg_4_l4[2])
print("(mT)B=",linear_reg_4_l4[2]/(4*(10**-2)))
print("declive para 4 ímanes l=2.70",linear_reg_4_l2_70[2])
print("(mT)B=",linear_reg_4_l2_70[2]/(2.70*(10**-2)))
print("declive para 4 ímanes l=2.10",linear_reg_4_l2_10[2])
print("(mT)B=",linear_reg_4_l2_10[2]/(2.10*(10**-2)))
print("avg(mT)B=",(
                (linear_reg_4_l4[2]/(4*(10**-2))
                + linear_reg_4_l2_70[2]/(2.70*(10**-2))
                + linear_reg_4_l2_10[2]/(2.10*(10**-2))
                )/3
    ))
intensidadeB_l_4.append(linear_reg_4_l4[2])
intensidadeB_l_2_70.append(linear_reg_4_l2_70[2])
intensidadeB_l_2_10.append(linear_reg_4_l2_10[2])
print(r"$(mT)B_{magnet}$=", (linear_reg_4_l4[2]/(4*(10**-2))
                            + linear_reg_4_l2_70[2]/(2.70*(10**-2))
                            + linear_reg_4_l2_10[2]/(2.10*(10**-2))
                            )/12
                            )
print("----------------------------------------------")

# plots emf for 4 magnets, each line is a radius
linear_reg_4_r7_85 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.005,0.004,0.002])
linear_reg_4_r16 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.008,0.006,0.004])
linear_reg_4_r31_90 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.014,0.01,0.007])
pylab.figure(figsize=(12,10))
# pylab.title("FEM induzida em função da largura. Configuração 4 ímans.")
pylab.plot(linear_reg_4_r7_85[0], linear_reg_4_r7_85[1],'r--')
pylab.plot([0.04,0.028,0.02], [0.005,0.004,0.002], 'ro', label=r'$r=7.85\pm0.05mm$')
pylab.plot(linear_reg_4_r16[0], linear_reg_4_r16[1],'k--')
pylab.plot([0.04,0.028,0.02], [0.008,0.006,0.004], 'ko', label=r'$r=16.00\pm0.05mm$')
pylab.plot(linear_reg_4_r31_90[0], linear_reg_4_r31_90[1],'b--')
pylab.plot([0.04,0.028,0.02], [0.014,0.01,0.007], 'bo', label=r'$r=31.90\pm0.05mm$')
pylab.legend(fontsize=23)
pylab.xticks(fontsize=23)
pylab.yticks(fontsize=23)
pylab.xlabel(r"$\ell(m)$",fontsize=23)
pylab.ylabel(r"$\epsilon(mV)$",fontsize=23)
pylab.savefig("i4lfem.png")
pylab.show()
print("declive para 4 ímanes r=7.85",linear_reg_4_r7_85[2])
print("(mT)B=",linear_reg_4_r7_85[2]/(7.85*(10**-3)))
print("declive para 4 ímanes r=16",linear_reg_4_r16[2])
print("(mT)B=",linear_reg_4_r16[2]/(16*(10**-3)))
print("declive para 4 ímanes r=31.90",linear_reg_4_r31_90[2])
print("(mT)B=",linear_reg_4_r31_90[2]/(31.90*(10**-3)))
print("avg(mT)B=",(
                (linear_reg_4_r7_85[2]/(7.85*(10**-3))
                + linear_reg_4_r16[2]/(16*(10**-3))
                + linear_reg_4_r31_90[2]/(31.90*(10**-3))
                )/3
    ))
intensidadeB_r7_85.append(linear_reg_4_r7_85[2])
intensidadeB_r_16.append(linear_reg_4_r16[2])
intensidadeB_r_31_90.append(linear_reg_4_r31_90[2])
print(r"$(mT)B_{magnet}$=", (linear_reg_4_r7_85[2]/(7.85*(10**-3))
                            + linear_reg_4_r16[2]/(16*(10**-3))
                            + linear_reg_4_r31_90[2]/(31.90*(10**-3))
                            )/12
                            )
print("----------------------------------------------")


# plots emf for 6 magnets, each line is a length
linear_reg_6_l4 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.008,0.016,0.03])
linear_reg_6_l2_70 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.004,0.008,0.016])
linear_reg_6_l2_10 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.003,0.007,0.015])
# pylab.title("FEM induzida em função do raio do enrolamento do fio. Configuração 6 ímans.")
pylab.figure(figsize=(12,10))
pylab.plot(linear_reg_6_l4[0], linear_reg_6_l4[1],'r--')
pylab.plot([0.00785,0.016,0.0319], [0.008,0.016,0.03], 'ro', label=r'$\ell=4.00\pm0.05cm$')
pylab.plot(linear_reg_6_l2_70[0], linear_reg_6_l2_70[1],'k--')
pylab.plot([0.00785,0.016,0.0319], [0.004,0.008,0.016], 'ko', label=r'$\ell=2.70\pm0.05cm$')
pylab.plot(linear_reg_6_l2_10[0], linear_reg_6_l2_10[1],'b--')
pylab.plot([0.00785,0.016,0.0319], [0.003,0.007,0.015], 'bo', label=r'$\ell=2.10\pm0.05cm$')
pylab.legend(fontsize=23)
pylab.xticks(fontsize=23)
pylab.yticks(fontsize=23)
pylab.xlabel(r"$r(m)$",fontsize=23)
pylab.ylabel(r"$\epsilon(mV)$",fontsize=23)
pylab.savefig("i6rfem.png")
pylab.show()
print("declive para 6 ímanes l=4",linear_reg_6_l4[2])
print("(mT)B=",linear_reg_6_l4[2]/(4*(10**-2)))
print("declive para 6 ímanes l=2.70",linear_reg_6_l2_70[2])
print("(mT)B=",linear_reg_6_l2_70[2]/(2.70*(10**-2)))
print("declive para 6 ímanes l=2.10",linear_reg_6_l2_10[2])
print("(mT)B=",linear_reg_6_l2_10[2]/(2.10*(10**-2)))
print("avg(mT)B=",(
                (linear_reg_6_l4[2]/(4*(10**-2))
                + linear_reg_6_l2_70[2]/(2.70*(10**-2))
                + linear_reg_6_l2_10[2]/(2.10*(10**-2))
                )/3
    ))
intensidadeB_l_4.append(linear_reg_6_l4[2])
intensidadeB_l_2_70.append(linear_reg_6_l2_70[2])
intensidadeB_l_2_10.append(linear_reg_6_l2_10[2])
print(r"$(mT)B_{magnet}$=", (linear_reg_6_l4[2]/(4*(10**-2))
                            + linear_reg_6_l2_70[2]/(2.70*(10**-2))
                            + linear_reg_6_l2_10[2]/(2.10*(10**-2))
                            )/18
                            )
print("----------------------------------------------")


# plots emf for 6 magnets, each line is a radius
linear_reg_6_r7_85 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.006,0.004,0.002])
linear_reg_6_r16 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.012,0.008,0.005])
linear_reg_6_r31_90 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.022,0.016,0.01])
# pylab.title("FEM induzida em função da largura do circuito. Configuração 6 ímans.")
pylab.figure(figsize=(12,10))
pylab.plot(linear_reg_6_r7_85[0], linear_reg_6_r7_85[1],'r--')
pylab.plot([0.04,0.028,0.02], [0.006,0.004,0.002], 'ro', label=r'$r=7.85\pm0.05mm$')
pylab.plot(linear_reg_6_r16[0], linear_reg_6_r16[1],'k--')
pylab.plot([0.04,0.028,0.02], [0.012,0.008,0.005], 'ko', label=r'$r=16.00\pm0.05mm$')
pylab.plot(linear_reg_6_r31_90[0], linear_reg_6_r31_90[1],'b--')
pylab.plot([0.04,0.028,0.02], [0.022,0.016,0.01], 'bo', label=r'$r=31.90\pm0.05mm$')
pylab.legend(fontsize=23)
pylab.xticks(fontsize=23)
pylab.yticks(fontsize=23)
pylab.xlabel(r"$\ell(m)$",fontsize=23)
pylab.ylabel(r"$\epsilon(m)$",fontsize=23)
pylab.savefig("i6lfem.png")
pylab.show()
print("declive para 6 ímanes r=7.85",linear_reg_6_r7_85[2])
print("(mT)B=",linear_reg_6_r7_85[2]/(7.85*(10**-3)))
print("declive para 6 ímanes r=16",linear_reg_6_r16[2])
print("(mT)B=",linear_reg_6_r16[2]/(16*(10**-3)))
print("declive para 6 ímanes r=31.90",linear_reg_6_r31_90[2])
print("(mT)B=",linear_reg_6_r31_90[2]/(31.90*(10**-3)))
print("avg(mT)B=",(
                (linear_reg_6_r7_85[2]/(7.85*(10**-3))
                + linear_reg_6_r16[2]/(16*(10**-3))
                + linear_reg_6_r31_90[2]/(31.90*(10**-3))
                )/3
    ))
intensidadeB_r7_85.append(linear_reg_6_r7_85[2])
intensidadeB_r_16.append(linear_reg_6_r16[2])
intensidadeB_r_31_90.append(linear_reg_6_r31_90[2])
print(r"$(mT)B_{magnet}$=", (linear_reg_6_r7_85[2]/(7.85*(10**-3))
                            + linear_reg_6_r16[2]/(16*(10**-3))
                            + linear_reg_6_r31_90[2]/(31.90*(10**-3))
                            )/18
                            )
print("----------------------------------------------")


# plots emf for 8 magnets, each line is a length
linear_reg_8_l4 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.008,0.016,0.03])
linear_reg_8_l2_70 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.005,0.01,0.02])
linear_reg_8_l2_10 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.003,0.007,0.015])
# pylab.title("FEM induzida em função do raio do enrolamento do fio. Configuração 8 ímans.")
pylab.figure(figsize=(12,10))
pylab.plot(linear_reg_8_l4[0], linear_reg_8_l4[1],'r--')
pylab.plot([0.00785,0.016,0.0319], [0.008,0.016,0.03], 'ro', label=r'$\ell=4.00\pm0.05cm$')
pylab.plot(linear_reg_8_l2_70[0], linear_reg_8_l2_70[1],'k--')
pylab.plot([0.00785,0.016,0.0319], [0.005,0.01,0.02], 'ko', label=r'$\ell=2.70\pm0.05cm$')
pylab.plot(linear_reg_8_l2_10[0], linear_reg_8_l2_10[1],'b--')
pylab.plot([0.00785,0.016,0.0319], [0.003,0.007,0.015], 'bo', label=r'$\ell=2.10\pm0.05cm$')
pylab.legend(fontsize=23)
pylab.xticks(fontsize=23)
pylab.yticks(fontsize=23)
pylab.xlabel(r"$r(m)$",fontsize=23)
pylab.ylabel(r"$\epsilon(mV)$",fontsize=23)
pylab.savefig("i8rfem.png")
pylab.show()
print("declive para 8 ímanes l=4",linear_reg_8_l4[2])
print("(mT)B=",linear_reg_8_l4[2]/(4*(10**-2)))
print("declive para 8 ímanes l=2.70",linear_reg_8_l2_70[2])
print("(mT)B=",linear_reg_8_l2_70[2]/(2.70*(10**-2)))
print("declive para 8 ímanes l=2.10",linear_reg_8_l2_10[2])
print("(mT)B=",linear_reg_8_l2_10[2]/(2.10*(10**-2)))
print("avg(mT)B=",(
                (linear_reg_8_l4[2]/(4*(10**-2))
                + linear_reg_8_l2_70[2]/(2.70*(10**-2))
                + linear_reg_8_l2_10[2]/(2.10*(10**-2))
                )/3
    ))
intensidadeB_l_4.append(linear_reg_8_l4[2])
intensidadeB_l_2_70.append(linear_reg_8_l2_70[2])
intensidadeB_l_2_10.append(linear_reg_8_l2_10[2])
print(r"$(mT)B_{magnet}$=", (linear_reg_8_l4[2]/(4*(10**-2))
                            + linear_reg_8_l2_70[2]/(2.70*(10**-2))
                            + linear_reg_8_l2_10[2]/(2.10*(10**-2))
                            )/24
                            )
print("----------------------------------------------")


# plots emf for 8 magnets, each line is a radius
linear_reg_8_r7_85 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.008,0.005,0.003])
linear_reg_8_r16 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.016,0.01,0.007])
linear_reg_8_r31_90 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.03,0.02,0.015])
# pylab.title("FEM induzida em função da largura do circuito. Configuração 8 ímans.")
pylab.figure(figsize=(12,10))
pylab.plot(linear_reg_8_r7_85[0], linear_reg_8_r7_85[1],'r--')
pylab.plot([0.04,0.028,0.02], [0.008,0.005,0.003], 'ro', label=r'$r=7.85\pm0.05mm$')
pylab.plot(linear_reg_8_r16[0], linear_reg_8_r16[1],'k--')
pylab.plot([0.04,0.028,0.02], [0.016,0.01,0.007], 'ko', label=r'$r=16.00\pm0.05mm$')
pylab.plot(linear_reg_8_r31_90[0], linear_reg_8_r31_90[1],'b--')
pylab.plot([0.04,0.028,0.02], [0.03,0.02,0.015], 'bo', label=r'$r=31.90\pm0.05mm$')
pylab.legend(fontsize=23)
pylab.xticks(fontsize=23)
pylab.yticks(fontsize=23)
pylab.xlabel(r"$\ell(m)$",fontsize=23)
pylab.ylabel(r"$\epsilon(m)$",fontsize=23)
pylab.savefig("i8lfem.png")
pylab.show()
print("declive para 8 ímanes r=7.85",linear_reg_8_r7_85[2])
print("(mT)B=",linear_reg_8_r7_85[2]/(7.85*(10**-3)))
print("declive para 8 ímanes r=16",linear_reg_8_r16[2])
print("(mT)B=",linear_reg_8_r16[2]/(16*(10**-3)))
print("declive para 8 ímanes r=31.90",linear_reg_8_r31_90[2])
print("(mT)B=",linear_reg_8_r31_90[2]/(31.90*(10**-3)))
print("avg(mT)B=",(
                (linear_reg_8_r7_85[2]/(7.85*(10**-3))
                + linear_reg_8_r16[2]/(16*(10**-3))
                + linear_reg_8_r31_90[2]/(31.90*(10**-3))
                )/3
    ))
intensidadeB_r7_85.append(linear_reg_8_r7_85[2])
intensidadeB_r_16.append(linear_reg_8_r16[2])
intensidadeB_r_31_90.append(linear_reg_8_r31_90[2])
print(r"$(mT)B_{magnet}$=", (linear_reg_8_r7_85[2]/(7.85*(10**-3))
                            + linear_reg_8_r16[2]/(16*(10**-3))
                            + linear_reg_8_r31_90[2]/(31.90*(10**-3))
                            )/24
                            )
print("----------------------------------------------")


# plots emf for 10 magnets, each line is a length
linear_reg_10_l4 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.009,0.018,0.035])
linear_reg_10_l2_70 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.006,0.012,0.025])
linear_reg_10_l2_10 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.004,0.008,0.015])
# pylab.title("FEM induzida em função do raio do enrolamento do fio. Configuração 10 ímans.")
pylab.figure(figsize=(12,10))
pylab.plot(linear_reg_10_l4[0], linear_reg_10_l4[1],'r--')
pylab.plot([0.00785,0.016,0.0319], [0.009,0.018,0.035], 'ro', label=r'$\ell=4.00\pm0.05cm$')
pylab.plot(linear_reg_10_l2_70[0], linear_reg_10_l2_70[1],'k--')
pylab.plot([0.00785,0.016,0.0319], [0.006,0.012,0.025], 'ko', label=r'$\ell=2.70\pm0.05cm$')
pylab.plot(linear_reg_10_l2_10[0], linear_reg_10_l2_10[1],'b--')
pylab.plot([0.00785,0.016,0.0319], [0.004,0.008,0.015], 'bo', label=r'$\ell=2.10\pm0.05cm$')
pylab.legend(fontsize=23)
pylab.xticks(fontsize=23)
pylab.yticks(fontsize=23)
pylab.xlabel(r"$r(m)$",fontsize=23)
pylab.ylabel(r"$\epsilon(mV)$",fontsize=23)
pylab.savefig("i10rfem.png")
pylab.show()
print("declive para 10 ímanes l=4",linear_reg_10_l4[2])
print("(mT)B=",linear_reg_10_l4[2]/(4*(10**-2)))
print("declive para 10 ímanes l=2.70",linear_reg_10_l2_70[2])
print("(mT)B=",linear_reg_10_l2_70[2]/(2.70*(10**-2)))
print("declive para 10 ímanes l=2.10",linear_reg_10_l2_10[2])
print("(mT)B=",linear_reg_10_l2_10[2]/(2.10*(10**-2)))
print("avg(mT)B=",(
                (linear_reg_10_l4[2]/(4*(10**-2))
                + linear_reg_10_l2_70[2]/(2.70*(10**-2))
                + linear_reg_10_l2_10[2]/(2.10*(10**-2))
                )/3
    ))
intensidadeB_l_4.append(linear_reg_10_l4[2])
intensidadeB_l_2_70.append(linear_reg_10_l2_70[2])
intensidadeB_l_2_10.append(linear_reg_10_l2_10[2])
print(r"$(mT)B_{magnet}$=", (linear_reg_10_l4[2]/(4*(10**-2))
                            + linear_reg_10_l2_70[2]/(2.70*(10**-2))
                            + linear_reg_10_l2_10[2]/(2.10*(10**-2))
                            )/30
                            )
print("----------------------------------------------")


# plots emf for 10 magnets, each line is a radius
linear_reg_10_r7_85 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.009,0.006,0.004])
linear_reg_10_r16 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.018,0.012,0.008])
linear_reg_10_r31_90 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.035,0.025,0.015])
# pylab.title("FEM induzida em função da largura do circuito. Configuração 10 ímans.")
pylab.figure(figsize=(12,10))
pylab.plot(linear_reg_10_r7_85[0], linear_reg_10_r7_85[1],'r--')
pylab.plot([0.04,0.028,0.02], [0.009,0.006,0.004], 'ro', label=r'$r=7.85\pm0.05mm$')
pylab.plot(linear_reg_10_r16[0], linear_reg_10_r16[1],'k--')
pylab.plot([0.04,0.028,0.02], [0.018,0.012,0.008], 'ko', label=r'$r=16.00\pm0.05mm$')
pylab.plot(linear_reg_10_r31_90[0], linear_reg_10_r31_90[1],'b--')
pylab.plot([0.04,0.028,0.02], [0.035,0.025,0.015], 'bo', label=r'$r=31.90\pm0.05mm$')
pylab.legend(fontsize=23)
pylab.xticks(fontsize=23)
pylab.yticks(fontsize=23)
pylab.xlabel(r"$\ell(m)$",fontsize=23)
pylab.ylabel(r"$\epsilon(mV)$",fontsize=23)
pylab.savefig("i10lfem.png")
pylab.show()
print("declive para 10 ímanes r=7.85",linear_reg_10_r7_85[2])
print("(mT)B=",linear_reg_10_r7_85[2]/(7.85*(10**-3)))
print("declive para 10 ímanes r=16",linear_reg_10_r16[2])
print("(mT)B=",linear_reg_10_r16[2]/(16*(10**-3)))
print("declive para 10 ímanes r=31.90",linear_reg_10_r31_90[2])
print("(mT)B=",linear_reg_10_r31_90[2]/(31.90*(10**-3)))
print("avg(mT)B=",(
                (linear_reg_10_r7_85[2]/(7.85*(10**-3))
                + linear_reg_10_r16[2]/(16*(10**-3))
                + linear_reg_10_r31_90[2]/(31.90*(10**-3))
                )/3
    ))
intensidadeB_r7_85.append(linear_reg_10_r7_85[2])
intensidadeB_r_16.append(linear_reg_10_r16[2])
intensidadeB_r_31_90.append(linear_reg_10_r31_90[2])
print(r"$(mT)B_{magnet}$=", (linear_reg_10_r7_85[2]/(7.85*(10**-3))
                            + linear_reg_10_r16[2]/(16*(10**-3))
                            + linear_reg_10_r31_90[2]/(31.90*(10**-3))
                            )/30
                            )
print("----------------------------------------------")


# plots emf for 12 magnets, each line is a length
linear_reg_12_l4 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.011,0.021,0.0425])
linear_reg_12_l2_70 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.007,0.014,0.029])
linear_reg_12_l2_10 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.005,0.01,0.02])
# pylab.title("FEM induzida em função do raio do enrolamento do fio. Configuração 12 ímans.")
pylab.figure(figsize=(12,10))
pylab.plot(linear_reg_12_l4[0], linear_reg_12_l4[1],'r--')
pylab.plot([0.00785,0.016,0.0319], [0.011,0.021,0.0425], 'ro', label=r'$\ell=4.00\pm0.05cm$')
pylab.plot(linear_reg_12_l2_70[0], linear_reg_12_l2_70[1],'k--')
pylab.plot([0.00785,0.016,0.0319], [0.007,0.014,0.029], 'ko', label=r'$\ell=2.70\pm0.05cm$')
pylab.plot(linear_reg_12_l2_10[0], linear_reg_12_l2_10[1],'b--')
pylab.plot([0.00785,0.016,0.0319], [0.005,0.01,0.02], 'bo', label=r'$\ell=2.10\pm0.05cm$')
pylab.legend(fontsize=23)
pylab.xticks(fontsize=23)
pylab.yticks(fontsize=23)
pylab.xlabel(r"$r(m)$",fontsize=23)
pylab.ylabel(r"$\epsilon(mV)$",fontsize=23)
pylab.savefig("i12rfem.png")
pylab.show()
print("declive para 12 ímanes l=4",linear_reg_12_l4[2])
print("(mT)B=",linear_reg_12_l4[2]/(4*(10**-2)))
print("declive para 12 ímanes l=2.70",linear_reg_12_l2_70[2])
print("(mT)B=",linear_reg_12_l2_70[2]/(2.70*(10**-2)))
print("declive para 12 ímanes l=2.10",linear_reg_12_l2_10[2])
print("(mT)B=",linear_reg_12_l2_10[2]/(2.10*(10**-2)))
print("avg(mT)B=",(
                (linear_reg_12_l4[2]/(4*(10**-2))
                + linear_reg_12_l2_70[2]/(2.70*(10**-2))
                + linear_reg_12_l2_10[2]/(2.10*(10**-2))
                )/3
    ))
intensidadeB_l_4.append(linear_reg_12_l4[2])
intensidadeB_l_2_70.append(linear_reg_12_l2_70[2])
intensidadeB_l_2_10.append(linear_reg_12_l2_10[2])
print(r"$(mT)B_{magnet}$=", (linear_reg_12_l4[2]/(4*(10**-2))
                            + linear_reg_12_l2_70[2]/(2.70*(10**-2))
                            + linear_reg_12_l2_10[2]/(2.10*(10**-2))
                            )/36
                            )
print("----------------------------------------------")


# plots emf for 12 magnets, each line is a radius
linear_reg_12_r7_85 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.011,0.007,0.005])
linear_reg_12_r16 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.021,0.014,0.01])
linear_reg_12_r31_90 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.0425,0.029,0.02])
# pylab.title("FEM induzida em função da largura do circuito. Configuração 12 ímans.")
pylab.figure(figsize=(12,10))
pylab.plot(linear_reg_12_r7_85[0], linear_reg_12_r7_85[1],'r--')
pylab.plot([0.04,0.028,0.02], [0.011,0.007,0.005], 'ro', label=r'$r=7.85\pm0.05mm$')
pylab.plot(linear_reg_12_r16[0], linear_reg_12_r16[1],'k--')
pylab.plot([0.04,0.028,0.02], [0.021,0.014,0.01], 'ko', label=r'$r=16.00\pm0.05mm$')
pylab.plot(linear_reg_12_r31_90[0], linear_reg_12_r31_90[1],'b--')
pylab.plot([0.04,0.028,0.02], [0.0425,0.029,0.02], 'bo', label=r'$r=31.90\pm0.05mm$')
pylab.legend(fontsize=23)
pylab.xticks(fontsize=23)
pylab.yticks(fontsize=23)
pylab.xlabel(r"$\ell(m)$",fontsize=23)
pylab.ylabel(r"$\epsilon(m)$",fontsize=23)
pylab.savefig("i12lfem.png")
pylab.show()
print("declive para 12 ímanes r=7.85",linear_reg_12_r7_85[2])
print("(mT)B=",linear_reg_12_r7_85[2]/(7.85*(10**-3)))
print("declive para 12 ímanes r=16",linear_reg_12_r16[2])
print("(mT)B=",linear_reg_12_r16[2]/(16*(10**-3)))
print("declive para 12 ímanes r=31.90",linear_reg_12_r31_90[2])
print("(mT)B=",linear_reg_12_r31_90[2]/(31.90*(10**-3)))
print("avg(mT)B=",(
                (linear_reg_12_r7_85[2]/(7.85*(10**-3))
                + linear_reg_12_r16[2]/(16*(10**-3))
                + linear_reg_12_r31_90[2]/(31.90*(10**-3))
                )/3
    ))
intensidadeB_r7_85.append(linear_reg_12_r7_85[2])
intensidadeB_r_16.append(linear_reg_12_r16[2])
intensidadeB_r_31_90.append(linear_reg_12_r31_90[2])
print(r"$(mT)B_{magnet}$=", (linear_reg_12_r7_85[2]/(7.85*(10**-3))
                            + linear_reg_12_r16[2]/(16*(10**-3))
                            + linear_reg_12_r31_90[2]/(31.90*(10**-3))
                            )/36
                            )
print("----------------------------------------------")


# plots emf for 16 magnets, each line is a length
linear_reg_16_l4 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.014,0.029,0.06])
linear_reg_16_l2_70 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.009,0.02,0.04])
linear_reg_16_l2_10 = linear_regression_line_coordinates([0.00785,0.016,0.0319],[0.006,0.014,0.03])
pylab.figure(figsize=(12,10))
# pylab.title("FEM induzida em função do raio do enrolamento do fio. Configuração 16 ímans.")
pylab.plot(linear_reg_16_l4[0], linear_reg_16_l4[1],'r--')
pylab.plot([0.00785,0.016,0.0319], [0.014,0.029,0.06], 'ro', label=r'$\ell=4.00\pm0.05cm$')
pylab.plot(linear_reg_16_l2_70[0], linear_reg_16_l2_70[1],'k--')
pylab.plot([0.00785,0.016,0.0319], [0.009,0.02,0.04], 'ko', label=r'$\ell=2.70\pm0.05cm$')
pylab.plot(linear_reg_16_l2_10[0], linear_reg_16_l2_10[1],'b--')
pylab.plot([0.00785,0.016,0.0319], [0.006,0.014,0.03], 'bo', label=r'$\ell=2.10\pm0.05cm$')
pylab.legend(fontsize=23)
pylab.xticks(fontsize=23)
pylab.yticks(fontsize=23)
pylab.xlabel(r"$r(m)$",fontsize=23)
pylab.ylabel(r"$\epsilon(mV)$",fontsize=23)
pylab.savefig("i16rfem.png")
pylab.show()
print("declive para 16 ímanes l=4",linear_reg_16_l4[2])
print("(mT)B=",linear_reg_16_l4[2]/(4*(10**-2)))
print("declive para 16 ímanes l=2.70",linear_reg_16_l2_70[2])
print("(mT)B=",linear_reg_16_l2_70[2]/(2.70*(10**-2)))
print("declive para 16 ímanes l=2.10",linear_reg_16_l2_10[2])
print("(mT)B=",linear_reg_16_l2_10[2]/(2.10*(10**-2)))
print("avg(mT)B=",(
                (linear_reg_16_l4[2]/(4*(10**-2))
                + linear_reg_16_l2_70[2]/(2.70*(10**-2))
                + linear_reg_16_l2_10[2]/(2.10*(10**-2))
                )/3
    ))
intensidadeB_l_4.append(linear_reg_16_l4[2])
intensidadeB_l_2_70.append(linear_reg_16_l2_70[2])
intensidadeB_l_2_10.append(linear_reg_16_l2_10[2])
print(r"$(mT)B_{magnet}$=", (linear_reg_16_l4[2]/(4*(10**-2))
                            + linear_reg_16_l2_70[2]/(2.70*(10**-2))
                            + linear_reg_16_l2_10[2]/(2.10*(10**-2))
                            )/48
                            )
print("----------------------------------------------")


# plots emf for 16 magnets, each line is a radius
linear_reg_16_r7_85 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.014,0.009,0.006])
linear_reg_16_r16 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.029,0.02,0.014])
linear_reg_16_r31_90 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.06,0.04,0.03])
pylab.figure(figsize=(12,10))
# pylab.title("FEM induzida em função da largura do circuito. Configuração 16 ímans.")
pylab.plot(linear_reg_16_r7_85[0], linear_reg_16_r7_85[1],'r--')
pylab.plot([0.04,0.028,0.02], [0.014,0.009,0.006], 'ro', label=r'$r=7.85\pm0.05mm$')
pylab.plot(linear_reg_16_r16[0], linear_reg_16_r16[1],'k--')
pylab.plot([0.04,0.028,0.02], [0.029,0.02,0.014], 'ko', label=r'$r=16.00\pm0.05mm$')
pylab.plot(linear_reg_16_r31_90[0], linear_reg_16_r31_90[1],'b--')
pylab.plot([0.04,0.028,0.02], [0.06,0.04,0.03], 'bo', label=r'$r=31.90\pm0.05mm$')
pylab.legend(fontsize=23)
pylab.xticks(fontsize=23)
pylab.yticks(fontsize=23)
pylab.xlabel(r"$\ell(m)$",fontsize=23)
pylab.ylabel(r"$\epsilon(mV)$",fontsize=23)
pylab.savefig("i16lfem.png")
pylab.show()
print("declive para 16 ímanes r=7.85",linear_reg_16_r7_85[2])
print("(mT)B=",linear_reg_16_r7_85[2]/(7.85*(10**-3)))
print("declive para 16 ímanes r=16",linear_reg_16_r16[2])
print("(mT)B=",linear_reg_16_r16[2]/(16*(10**-3)))
print("declive para 16 ímanes r=31.90",linear_reg_16_r31_90[2])
print("(mT)B=",linear_reg_16_r31_90[2]/(31.90*(10**-3)))
print("avg(mT)B=",(
                (linear_reg_16_r7_85[2]/(7.85*(10**-3))
                + linear_reg_16_r16[2]/(16*(10**-3))
                + linear_reg_16_r31_90[2]/(31.90*(10**-3))
                )/3
    ))
intensidadeB_r7_85.append(linear_reg_16_r7_85[2])
intensidadeB_r_16.append(linear_reg_16_r16[2])
intensidadeB_r_31_90.append(linear_reg_16_r31_90[2])
print(r"$(mT)B_{magnet}$=", (linear_reg_16_r7_85[2]/(7.85*(10**-3))
                            + linear_reg_16_r16[2]/(16*(10**-3))
                            + linear_reg_16_r31_90[2]/(31.90*(10**-3))
                            )/48
                            )
print("----------------------------------------------")


# plots emf for r=7.85mm, each line is a determined number of magnets
linear_reg_r7_85_m4 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.005,0.004,0.002])
linear_reg_r7_85_m6 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.006,0.004,0.002])
linear_reg_r7_85_m8 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.008,0.005,0.003])
linear_reg_r7_85_m10 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.009,0.006,0.004])
linear_reg_r7_85_m12 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.011,0.007,0.005])
linear_reg_r7_85_m16 = linear_regression_line_coordinates([0.04,0.028,0.02],[0.014,0.009,0.006])
pylab.figure(figsize=(12,10))
# pylab.title(r"FEM induzida em função da largura. Configuração $r=7.85\pm0.05mm$")
# pylab.plot(linear_reg_r7_85_m4[0], linear_reg_r7_85_m4[1],'r--')
# pylab.plot([0.04,0.028,0.02], [0.005,0.004,0.002], 'ro', label=r'4 ímans')
pylab.plot(linear_reg_r7_85_m6[0], linear_reg_r7_85_m6[1],'k--')
pylab.plot([0.04,0.028,0.02], [0.006,0.004,0.002], 'ko', label=r'6 ímans')
pylab.plot(linear_reg_r7_85_m8[0], linear_reg_r7_85_m8[1],'b--')
pylab.plot([0.04,0.028,0.02], [0.008,0.005,0.003], 'bo', label=r'8 ímans')
pylab.plot(linear_reg_r7_85_m10[0], linear_reg_r7_85_m10[1],'g--')
pylab.plot([0.04,0.028,0.02], [0.009,0.006,0.004], 'go', label=r'10 ímans')
pylab.plot(linear_reg_r7_85_m12[0], linear_reg_r7_85_m12[1],'c--')
pylab.plot([0.04,0.028,0.02], [0.011,0.007,0.005], 'co', label=r'12 ímans')
pylab.plot(linear_reg_r7_85_m16[0], linear_reg_r7_85_m16[1],'y--')
pylab.plot([0.04,0.028,0.02], [0.014,0.009,0.006], 'yo', label=r'16 ímans')
pylab.legend(fontsize=23)
pylab.xticks(fontsize=23)
pylab.yticks(fontsize=23)
pylab.xlabel(r"$\ell(m)$",fontsize=23)
pylab.ylabel(r"$\epsilon(mV)$",fontsize=23)
pylab.savefig("r785lfem.png")
pylab.show()



# plots emf for 4, 6, 8, 10, 12 and 16 magnets, each line is a radius
fig, ax = pylab.subplots(2, 3, sharex='col', sharey='row')
ax[0,0].plot(linear_reg_4_r7_85[0], linear_reg_4_r7_85[1],'r--')
ax[0,0].plot([0.04,0.028,0.02], [0.005,0.004,0.002], 'ro', label=r'$r=7.85\pm0.05mm$')
ax[0,0].plot(linear_reg_4_r16[0], linear_reg_4_r16[1],'k--')
ax[0,0].plot([0.04,0.028,0.02], [0.008,0.006,0.004], 'ko', label=r'$r=16.00\pm0.05mm$')
ax[0,0].plot(linear_reg_4_r31_90[0], linear_reg_4_r31_90[1],'b--')
ax[0,0].plot([0.04,0.028,0.02], [0.014,0.01,0.007], 'bo', label=r'$r=31.90\pm0.05mm$')
ax[0,0].title.set_text(r"$4$ ímanes")
ax[0,1].plot(linear_reg_6_r7_85[0], linear_reg_6_r7_85[1],'r--')
ax[0,1].plot([0.04,0.028,0.02], [0.006,0.004,0.002], 'ro')
ax[0,1].plot(linear_reg_6_r16[0], linear_reg_6_r16[1],'k--')
ax[0,1].plot([0.04,0.028,0.02], [0.012,0.008,0.005], 'ko')
ax[0,1].plot(linear_reg_6_r31_90[0], linear_reg_6_r31_90[1],'b--')
ax[0,1].plot([0.04,0.028,0.02], [0.022,0.016,0.01], 'bo')
ax[0,1].title.set_text(r"$6$ ímanes")
ax[0,2].plot(linear_reg_8_r7_85[0], linear_reg_8_r7_85[1],'r--')
ax[0,2].plot([0.04,0.028,0.02], [0.008,0.005,0.003], 'ro')
ax[0,2].plot(linear_reg_8_r16[0], linear_reg_8_r16[1],'k--')
ax[0,2].plot([0.04,0.028,0.02], [0.016,0.01,0.007], 'ko')
ax[0,2].plot(linear_reg_8_r31_90[0], linear_reg_8_r31_90[1],'b--')
ax[0,2].plot([0.04,0.028,0.02], [0.03,0.02,0.015], 'bo')
ax[0,2].title.set_text(r"$8$ ímanes")
ax[1,0].plot(linear_reg_10_r7_85[0], linear_reg_10_r7_85[1],'r--')
ax[1,0].plot([0.04,0.028,0.02], [0.009,0.006,0.004], 'ro')
ax[1,0].plot(linear_reg_10_r16[0], linear_reg_10_r16[1],'k--')
ax[1,0].plot([0.04,0.028,0.02], [0.018,0.012,0.008], 'ko')
ax[1,0].plot(linear_reg_10_r31_90[0], linear_reg_10_r31_90[1],'b--')
ax[1,0].plot([0.04,0.028,0.02], [0.035,0.025,0.015], 'bo')
ax[1,0].title.set_text(r"$10$ ímanes")
ax[1,1].plot(linear_reg_12_r7_85[0], linear_reg_12_r7_85[1],'r--')
ax[1,1].plot([0.04,0.028,0.02], [0.011,0.007,0.005], 'ro')
ax[1,1].plot(linear_reg_12_r16[0], linear_reg_12_r16[1],'k--')
ax[1,1].plot([0.04,0.028,0.02], [0.021,0.014,0.01], 'ko')
ax[1,1].plot(linear_reg_12_r31_90[0], linear_reg_12_r31_90[1],'b--')
ax[1,1].plot([0.04,0.028,0.02], [0.0425,0.029,0.02], 'bo')
ax[1,1].title.set_text(r"$12$ ímanes")
ax[1,2].plot(linear_reg_16_r7_85[0], linear_reg_16_r7_85[1],'r--')
ax[1,2].plot([0.04,0.028,0.02], [0.014,0.009,0.006], 'ro')
ax[1,2].plot(linear_reg_16_r16[0], linear_reg_16_r16[1],'k--')
ax[1,2].plot([0.04,0.028,0.02], [0.029,0.02,0.014], 'ko')
ax[1,2].plot(linear_reg_16_r31_90[0], linear_reg_16_r31_90[1],'b--')
ax[1,2].plot([0.04,0.028,0.02], [0.06,0.04,0.03], 'bo')
ax[1,2].title.set_text(r"$16$ ímanes")
fig.text(0.5, 0.04, r"$\ell(m)$", ha='center', va='center', fontsize=11)
fig.text(0.06, 0.5, r"$\epsilon(mV)$", ha='center', va='center', rotation='vertical', fontsize=11)
fig.legend(fontsize=11, loc='upper center',
           ncol=3, mode="expand")
pylab.show()



# Plots field intensity per number of magnets with l constant
pylab.figure(figsize=(12,10))
pylab.plot(numero_imanes,intensidadeB_l_2_70, 'bo', label=r'$\ell=2.70\pm0.05cm$')
linearB_l_2_70 = linear_regression_line_coordinates_magnets(numero_imanes,intensidadeB_l_2_70)
pylab.plot(linearB_l_2_70[0],linearB_l_2_70[1][0], 'b--')
pylab.text(10,0.6,r'$\epsilon=0.08265012N-0.04291277$',fontsize=17)
pylab.legend(fontsize=23)
pylab.xticks(fontsize=23)
pylab.yticks(fontsize=23)
pylab.xlabel(r"N",fontsize=23)
pylab.ylabel(r"$\epsilon(mV)$",fontsize=23)
pylab.savefig("bporimaneslconstante.png")
pylab.show()

# Plots field intensity per number of magnets with r constant
pylab.figure(figsize=(12,10))
pylab.plot(numero_imanes,intensidadeB_r_31_90, 'bo', label=r'$r=31.90\pm0.05mm$')
linearB_l_r_31_90 = linear_regression_line_coordinates_magnets(numero_imanes,intensidadeB_r_31_90)
pylab.plot(linearB_l_r_31_90[0],linearB_l_r_31_90[1][0], 'b--')
pylab.text(9.5,0.5,r'$\epsilon=0.09539474N-0.00328947$',fontsize=17)
pylab.legend(fontsize=23)
pylab.xticks(fontsize=23)
pylab.yticks(fontsize=23)
pylab.xlabel(r"N",fontsize=23)
pylab.ylabel(r"$\epsilon(mV)$",fontsize=23)
pylab.savefig("bporimanesrconstante.png")
pylab.show()
